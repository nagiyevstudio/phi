# Enable Rewrite Engine
RewriteEngine On

# Если есть заголовок Authorization, принудительно пишем его в переменную среды HTTP_AUTHORIZATION
RewriteCond %{HTTP:Authorization} .
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

# Pass Authorization header to PHP (для Apache с mod_rewrite)
# Используем SetEnvIf как более надежный способ
SetEnvIf Authorization "(.*)" HTTP_AUTHORIZATION=$1

# If the request is for a file or directory that exists, serve it directly
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Route all API requests to index.php
RewriteRule ^api/(.*)$ index.php/$1 [QSA,L]

# Set default charset
AddDefaultCharset UTF-8

# CORS headers are handled in index.php

