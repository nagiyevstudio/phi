# Настройка автоматической загрузки на FTP

Проект настроен для автоматической загрузки собранных файлов на FTP-сервер при каждом билде.

## Быстрая настройка

1. **Скопируйте пример конфигурации (из корня проекта):**
   ```bash
   cp secrets/ftp.example.json secrets/ftp.json
   ```

2. **Отредактируйте `secrets/ftp.json`** и укажите ваши FTP данные в секции `frontend`:
   ```json
{
  "frontend": {
    "host": "your-ftp-host.com",
    "user": "your-username",
    "password": "your-password",
    "port": 21,
    "localRoot": "./dist",
    "remoteRoot": "/phi.nagiyev.com",
    "include": ["*", "**/*"],
    "exclude": [".git/**", ".gitignore", ".DS_Store", "node_modules/**"],
    "deleteRemote": false,
    "forcePasv": true,
    "secure": true,
    "secureOptions": {
      "rejectUnauthorized": false
    }
  }
}
```

   **Для FTPS (FTP over SSL):** установите `"secure": true`

3. **Выполните билд:**
   ```bash
   npm run build
   ```

После успешной сборки файлы автоматически загрузятся на FTP-сервер!

## Параметры конфигурации

- **host** - адрес FTP-сервера (обязательно)
- **user** - имя пользователя (обязательно)
- **password** - пароль (обязательно)
- **port** - порт FTP (по умолчанию: 21)
- **localRoot** - локальная папка для загрузки (по умолчанию: `./dist`)
- **remoteRoot** - удаленная папка на сервере (для этого проекта: `/phi.nagiyev.com`)
- **include** - маски файлов для включения (по умолчанию: `["*", "**/*"]`)
- **exclude** - маски файлов для исключения
- **deleteRemote** - удалять ли файлы на сервере, которых нет локально (по умолчанию: `false`)
- **forcePasv** - использовать пассивный режим (по умолчанию: `true`)
- **secure** - использовать FTPS (FTP over SSL) (по умолчанию: `false`)
- **secureOptions** - опции SSL для FTPS:
  - **rejectUnauthorized** - отклонять ли самоподписанные сертификаты (по умолчанию: `false`)
- **sftp** - использовать SFTP вместо FTP (по умолчанию: `false`)

## Безопасность

⚠️ **Важно:** Файл `secrets/ftp.json` содержит чувствительные данные и добавлен в `.gitignore`. Никогда не коммитьте его в репозиторий!

## Отключение автоматической загрузки

Если нужно временно отключить автоматическую загрузку:

1. Переименуйте или удалите файл `secrets/ftp.json`
2. Или закомментируйте плагин в `vite.config.ts`:
   ```typescript
   plugins: [
     react(),
     // vitePluginFtp('../secrets/ftp.json'), // закомментировано
   ],
   ```

## Использование расширения SFTP для VS Code/Cursor

Если вы используете расширение SFTP, конфигурация уже создана в `.vscode/sftp.json`. 

1. Откройте файл `.vscode/sftp.json`
2. Укажите ваши FTP данные
3. Расширение будет автоматически синхронизировать файлы при сохранении (если включено `uploadOnSave: true`)

## Устранение проблем

### Ошибка подключения
- Проверьте правильность хоста, порта, имени пользователя и пароля
- Убедитесь, что сервер доступен и не блокируется файрволом
- Попробуйте изменить `forcePasv` на `false` или наоборот

### Файлы не загружаются
- Проверьте, что папка `dist` существует после билда
- Убедитесь, что путь `remoteRoot` существует на сервере
- Проверьте права доступа на FTP-сервере

### Плагин не запускается
- Убедитесь, что файл `secrets/ftp.json` существует в корне проекта
- Проверьте синтаксис JSON в конфигурационном файле
- Посмотрите логи в консоли при выполнении `npm run build`
